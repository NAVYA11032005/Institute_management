{% extends "m.html" %}
{% load static %}
{% block title %}Trash Overview{% endblock %}

{% block extra_head %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet"/>
<style>
  .nav-pills .nav-link.active {
    background-color: #0d6efd;
    color: white;
    box-shadow: 0 4px 6px rgba(13, 110, 253, 0.4);
  }
  .nav-pills .nav-link {
    transition: background-color 0.3s ease;
  }
  .nav-pills .nav-link:hover:not(.active) {
    background-color: #0b5ed7;
    color: white;
  }
  form.d-inline button.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }
</style>
{% endblock %}

{% block content %}
<div class="container my-4">
  <h1 class="mb-4">üóëÔ∏è Trash Overview</h1>

  <ul class="nav nav-pills flex-nowrap overflow-auto gap-2 shadow-sm rounded-3 px-2 py-2" style="white-space: nowrap; background: #f8f9fa;">
    <li class="nav-item" role="presentation">
      <button class="nav-link rounded-pill d-flex align-items-center gap-2 active" id="enrollments-tab" data-bs-toggle="pill" data-bs-target="#enrollments" type="button" role="tab" aria-controls="enrollments" aria-selected="true">
        <i class="bi bi-journal-check fs-5"></i> Enrollments
        <span class="badge bg-primary rounded-pill">{{ enrollments|length }}</span>
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link rounded-pill d-flex align-items-center gap-2" id="enquiries-tab" data-bs-toggle="pill" data-bs-target="#enquiries" type="button" role="tab" aria-controls="enquiries" aria-selected="false">
        <i class="bi bi-chat-left-text fs-5"></i> Enquiries
        <span class="badge bg-primary rounded-pill">{{ enquiries|length }}</span>
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link rounded-pill d-flex align-items-center gap-2" id="courses-tab" data-bs-toggle="pill" data-bs-target="#courses" type="button" role="tab" aria-controls="courses" aria-selected="false">
        <i class="bi bi-book fs-5"></i> Courses
        <span class="badge bg-primary rounded-pill">{{ courses|length }}</span>
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link rounded-pill d-flex align-items-center gap-2" id="expenses-tab" data-bs-toggle="pill" data-bs-target="#expenses" type="button" role="tab" aria-controls="expenses" aria-selected="false">
        <i class="bi bi-cash-stack fs-5"></i> Expenses
        <span class="badge bg-primary rounded-pill">{{ expenses|length }}</span>
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link rounded-pill d-flex align-items-center gap-2" id="teams-tab" data-bs-toggle="pill" data-bs-target="#teams" type="button" role="tab" aria-controls="teams" aria-selected="false">
        <i class="bi bi-people fs-5"></i> Teams
        <span class="badge bg-primary rounded-pill">{{ teams|length }}</span>
      </button>
    </li>
  </ul>

  <div class="tab-content mt-4" id="trashTabContent" style="min-height: 320px;">
    <!-- Enrollments Tab -->
    <div class="tab-pane fade show active" id="enrollments" role="tabpanel" aria-labelledby="enrollments-tab">
      {% if enrollments %}
        <div class="table-responsive">
          <table class="table table-striped table-hover align-middle">
            <thead class="table-dark">
              <tr>
                <th>#</th><th>ID</th><th>Student</th><th>Course</th><th>Enrollment Date</th><th>Deleted At</th><th>Action</th>
              </tr>
            </thead>
            <tbody>
              {% for enrollment in enrollments %}
                <tr>
                  <td>{{ forloop.counter }}</td>
                  <td>{{ enrollment.t_id }}</td>
                  <td>{% if enrollment.student %}{{ enrollment.student.full_name }}{% else %}N/A{% endif %}</td>
                  <td>{% if enrollment.course %}{{ enrollment.course.course_name }}{% else %}N/A{% endif %}</td>
                  <td>{{ enrollment.enrollment_date|date:"Y-m-d" }}</td>
                  <td>{{ enrollment.deleted_at|date:"Y-m-d H:i" }}</td>
                  <td>
                    <form action="{% url 'enrollment_restore' enrollment.pk %}" method="post" class="d-inline">
                      {% csrf_token %}
                      <button type="submit" class="btn btn-success btn-sm" title="Restore" aria-label="Restore">
                        <i class="bi bi-arrow-counterclockwise">Restore</i>
                      </button>
                    </form>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div class="alert alert-info">No enrollments in trash.</div>
      {% endif %}
    </div>

    <!-- Enquiries Tab -->
    <div class="tab-pane fade" id="enquiries" role="tabpanel" aria-labelledby="enquiries-tab">
      {% if enquiries %}
        <div class="table-responsive">
          <table class="table table-striped table-hover align-middle">
            <thead class="table-dark">
              <tr>
                <th>#</th><th>Name</th><th>Email</th><th>Phone</th><th>Course</th><th>State</th><th>Deleted At</th><th>Action</th>
              </tr>
            </thead>
            <tbody>
              {% for enquiry in enquiries %}
                <tr>
                  <td>{{ forloop.counter }}</td>
                  <td>{{ enquiry.name }}</td>
                  <td>{{ enquiry.email }}</td>
                  <td>{{ enquiry.phone }}</td>
                  <td>{% if enquiry.course %}{{ enquiry.course.course_name }}{% else %}N/A{% endif %}</td>
                  <td>{{ enquiry.state }}</td>
                  <td>{{ enquiry.deleted_at|date:"Y-m-d H:i" }}</td>
                  <td>
                    <form action="{% url 'enquiry_restore' enquiry.pk %}" method="post" class="d-inline">
                      {% csrf_token %}
                      <button type="submit" class="btn btn-success btn-sm" title="Restore" aria-label="Restore">
                        <i class="bi bi-arrow-counterclockwise">Restore</i>
                      </button>
                    </form>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div class="alert alert-info">No enquiries in trash.</div>
      {% endif %}
    </div>

    <!-- Courses Tab -->
    <div class="tab-pane fade" id="courses" role="tabpanel" aria-labelledby="courses-tab">
      {% if courses %}
        <div class="table-responsive">
          <table class="table table-striped table-hover align-middle">
            <thead class="table-dark">
              <tr>
                <th>#</th><th>Name</th><th>Fee (‚Çπ)</th><th>Duration</th><th>Duration Type</th><th>Deleted At</th><th>Action</th>
              </tr>
            </thead>
            <tbody>
              {% for course in courses %}
                <tr>
                  <td>{{ forloop.counter }}</td>
                  <td>{{ course.course_name }}</td>
                  <td>{{ course.course_fee|floatformat:2 }}</td>
                  <td>{{ course.course_duration }}</td>
                  <td>{{ course.get_duration_type_display }}</td>
                  <td>{{ course.deleted_at|date:"Y-m-d H:i" }}</td>
                  <td>
                    <form action="{% url 'course_restore' course.pk %}" method="post" class="d-inline">
                      {% csrf_token %}
                      <button type="submit" class="btn btn-success btn-sm" title="Restore" aria-label="Restore">
                        <i class="bi bi-arrow-counterclockwise">Restore</i>
                      </button>
                    </form>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div class="alert alert-info">No courses in trash.</div>
      {% endif %}
    </div>

    <!-- Expenses Tab -->
    <div class="tab-pane fade" id="expenses" role="tabpanel" aria-labelledby="expenses-tab">
      {% if expenses %}
        <div class="table-responsive">
          <table class="table table-striped table-hover align-middle">
            <thead class="table-dark">
              <tr>
                <th>#</th><th>Name</th><th>By</th><th>Amount (‚Çπ)</th><th>Date</th><th>Deleted At</th><th>Action</th>
              </tr>
            </thead>
            <tbody>
              {% for expense in expenses %}
                <tr>
                  <td>{{ forloop.counter }}</td>
                  <td>{{ expense.expense_name }}</td>
                  <td>{% if expense.expense_by %}{{ expense.expense_by.name }}{% else %}N/A{% endif %}</td>
                  <td>{{ expense.amount|floatformat:2 }}</td>
                  <td>{{ expense.date|date:"Y-m-d" }}</td>
                  <td>{{ expense.deleted_at|date:"Y-m-d H:i" }}</td>
                  <td>
                    <form action="{% url 'expense_restore' expense.pk %}" method="post" class="d-inline">
                      {% csrf_token %}
                      <button type="submit" class="btn btn-success btn-sm" title="Restore" aria-label="Restore">
                        <i class="bi bi-arrow-counterclockwise">Restore</i>
                      </button>
                    </form>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div class="alert alert-info">No expenses in trash.</div>
      {% endif %}
    </div>

    <!-- Teams Tab -->
    <div class="tab-pane fade" id="teams" role="tabpanel" aria-labelledby="teams-tab">
      {% if teams %}
        <div class="table-responsive">
          <table class="table table-striped table-hover align-middle">
            <thead class="table-dark">
              <tr>
                <th>#</th><th>Employee Code</th><th>Name</th><th>Designation</th><th>Email</th><th>Phone</th><th>City</th><th>State</th><th>Deleted At</th><th>Action</th>
              </tr>
            </thead>
            <tbody>
              {% for team in teams %}
                <tr>
                  <td>{{ forloop.counter }}</td>
                  <td>{{ team.employee_code }}</td>
                  <td>{{ team.name }}</td>
                  <td>{{ team.designation }}</td>
                  <td>{{ team.email }}</td>
                  <td>{{ team.phone }}</td>
                  <td>{{ team.city }}</td>
                  <td>{{ team.state }}</td>
                  <td>{{ team.deleted_at|date:"Y-m-d H:i" }}</td>
                  <td>
                    <form action="{% url 'team_restore' team.pk %}" method="post" class="d-inline">
                      {% csrf_token %}
                      <button type="submit" class="btn btn-success btn-sm" title="Restore" aria-label="Restore">
                        <i class="bi bi-arrow-counterclockwise">Restore</i>
                      </button>
                    </form>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div class="alert alert-info">No teams in trash.</div>
      {% endif %}
    </div>
  </div>

  <div class="mt-4">
    <a href="{% url 'student_list' %}" class="btn btn-secondary">
      <i class="bi bi-arrow-left"></i> Back to Students
    </a>
  </div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}

